<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <template id="reporte_de_tesoreria_pdf_preview">
            <t t-call="web.html_container">
                <t t-foreach="docs" t-as="o">
                    <div class="header">

                        <div class="row mt0 mb0" style="">
                            <div style="text-align:left;font-size:10px; width:50%;margin-top:12px;">

                                <h4 style="text-align: left; font-size:10px; line-height: 2px;">
                                    <div>
                                        <img t-att-src="image_data_uri(o.env.user.company_id.logo)"
                                            style="height: 90px; width: 250px; text-align: left; " />
                                        <br />
                                    </div>
                                </h4>
                            </div>
                            <div class="col-2" style="text-align:left; width: 30%;" name='as_titulo'>
                            </div>
                            <div style="text-align:left; width: 30%; margin-top:30px;" name='as_titulo'>
                                <table width="100%" style="border:#fffff 1px solid;">
                                    <tr>
                                        <td style="text-align: left; font-size:11px; width:100%; color:black; ">
                                            <b>NIT: <span t-esc="o.env.user.company_id.vat" /> </b>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="text-align: left; font-size:11px; width:100%; color:black;">
                                            <b>DIRECCION: <span t-esc="o.env.user.company_id.street" /> </b>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="text-align: left; font-size:11px; width:100%; color:black;">
                                            <b>TELEFONO, CELULAR: <span t-esc="o.env.user.company_id.phone" /> </b>
                                        </td>
                                    </tr>
                                </table>

                            </div>

                        </div>
                        <div style="margin-top:3px;">
                            <table width="100%">
                                <tr>
                                    <td
                                        style="width:100%; text-align:center;font-size:15px;color:#4682B4;border:0.5pt solid black;vertical-align: middle;">
                                        <b>LIBRO DE CAJA</b>
                                    </td>
                                </tr>
                                <tr>
                                    <td
                                        style="width:100%; text-align:center;font-size:15px;color:#4682B4;border:0.5pt solid black;vertical-align: middle;">

                                    </td>
                                </tr>
                            </table>
                        </div>
                        <div style="margin-top:8px;">
                            <table width="100%">
                                <tr style="width:100%;">
                                    <td width="50%">
                                        <b style="text-align:left; font-size: 12px; color:#4682B4;">Caja: </b>
                                        <b style="text-align:left; font-size: 12px; color:#black;"> <span
                                                t-esc="o.name" /></b>
                                    </td>
                                    <td width="50%">
                                        <b style="text-align:left; font-size: 12px; color:#4682B4;">Fecha de
                                            impresion:
                                        </b><b style="text-align:left; font-size: 12px;"><span
                                                t-esc="o._fecha_actual()" /></b>
                                    </td>
                                </tr>
                                <tr style="width:100%;">
                                    <td>
                                        <b style="text-align:left; font-size: 12px; color:#4682B4;">Usuario: </b><b
                                            style="text-align:left; font-size: 12px;"> <span
                                                t-esc="o.env.user.partner_id.name" /></b>
                                    </td>

                                </tr>
                            </table>
                        </div>
                    </div>

                </t>
            </t>

            <t t-call="web.external_layout">
                <t t-foreach="docs" t-as="o">
                    <div class="page" style="font-family: 'Arial' !important; ">
                        <style type="text/css">
                            .page {
                                margin: -40px 0px 0px 0px;
                                padding: 0px;
                            }

                            body {
                                font-family: 'Arial' !important;
                            }
                        </style>
                        <div>

                            <div style="">
                                <table width="100%">
                                    <thead>
                                        <tr
                                            style="text-align:center;font-size:12px; color:#ffffff ;background-color:#4682B4;border:0.5pt solid black;vertical-align: middle;">
                                            <td style="width:10%; border:0.5pt solid black;"><b>FECHA</b></td>
                                            <td style="width:10%; border:0.5pt solid black;"><b>DOCUMENTO</b></td>
                                            <td style="width:39%; border:0.5pt solid black;"><b>DESCRIPCION</b></td>
                                            <td style="width:12%; border:0.5pt solid black;"><b>INGRESO</b></td>
                                            <td style="width:12%; border:0.5pt solid black;"><b>EGRESO</b></td>
                                            <td style="width:15%; border:0.5pt solid black;"><b>SALDO</b></td>
                                        </tr>
                                        <tr>
                                            <td style="text-align: right; font-size:12px; width:10%;
                                            border-color: black; border:1px solid black;vertical-align: middle;">

                                            </td>
                                            <td
                                                style="text-align: left; font-size:12px; width:10%;text-wrap: True; border-color: black; border:1px solid black;vertical-align: middle;margin-left:5px;">

                                            </td>
                                            <td
                                                style="text-align: left; margin-left:5px; font-size:12px; width:39%; border-color: black; border:1px solid black;vertical-align: middle;">
                                                <p style="margin-left:5px;vertical-align: middle;">SALDO INICIAL CAJA
                                                </p>
                                            </td>
                                            <td
                                                style="text-align: right; font-size:12px; width:15%;text-wrap: True; border-color: black; border:1px solid black;vertical-align: middle;">
                                                <tspan t-esc="o.as_saldo_inicial" style="margin-right:5px;" />
                                            </td>
                                            <td
                                                style="text-align: right; font-size:12px; width:12%;text-wrap: True;border-color: black; border:1px solid black; vertical-align: middle;">

                                            </td>
                                            <td
                                                style="text-align: right; font-size:12px; width:12%;text-wrap: True;border-color: black; border:1px solid black; vertical-align: middle;">
                                                <tspan t-esc="o.as_saldo_inicial" style="margin-right:5px;" />
                                            </td>
                                        </tr>

                                    </thead>
                                    <thead style='border:1px solid grey' id="body_table">
                                        <t t-set="weight" t-value="0.00" />
                                        <div t-foreach="o.lineas_tesoreria()" t-as="d" width="100%">
                                            <tr>
                                                <td style="text-align: right; font-size:12px; width:10%;
                                            border-color: black; border:1px solid black;vertical-align: middle;">
                                                    <tspan t-esc="d['fecha']" style="margin-right:5px;" />
                                                </td>
                                                <td
                                                    style="text-align: left; font-size:12px; width:10%;text-wrap: True; border-color: black; border:1px solid black;vertical-align: middle;margin-left:5px;">
                                                    <tspan t-esc="d['documento']" style="margin-left:5px;" />
                                                </td>
                                                <td
                                                    style="text-align: left; font-size:12px; width:39%;text-wrap: True; border-color: black; border:1px solid black;vertical-align: middle;">
                                                    <p t-esc="d['nota']"
                                                        style="padding-left:10px;vertical-align: middle;"></p>
                                                </td>
                                                <td
                                                    style="text-align: center; font-size:12px; width:15%;text-wrap: True; border-color: black; border:1px solid black;vertical-align: middle;">

                                                </td>
                                                <td
                                                    style="text-align: right; font-size:12px; width:12%;text-wrap: True;border-color: black; border:1px solid black; vertical-align: middle;">
                                                    <tspan t-esc="'{:,.2f}'.format(d['monto'])"
                                                        style="margin-right:5px;" />
                                                </td>
                                                <td
                                                    style="text-align: right; font-size:12px; width:12%;text-wrap: True;border-color: black; border:1px solid black; vertical-align: middle;">
                                                    <tspan t-esc="'{:,.2f}'.format(d['vector_papa'])"
                                                        style="margin-right:5px;" />
                                                </td>

                                            </tr>
                                        </div>
                                    </thead>
                                    <thead style='border:1px solid grey' id="body_table">

                                        <tr>
                                            <td style="text-align: left; font-size:12px; 
                                            border-color: black; border:1px solid black;vertical-align: middle;"
                                                colspan="3">
                                                <b style="text-align:left;margin-left:20px;">TOTAL</b>
                                            </td>

                                            <td
                                                style="text-align: right; font-size:12px; border-color: black; border:1px solid black;vertical-align: middle;">
                                                <tspan t-esc="'{:,.2f}'.format(o.as_saldo_inicial)"
                                                    style="margin-right:5px;" />
                                            </td>
                                            <td
                                                style="text-align: right; font-size:12px;border-color: black; border:1px solid black; vertical-align: middle;">
                                                <tspan t-esc="'{:,.2f}'.format(o.obtener_totales())"
                                                    style="margin-right:5px;" />
                                            </td>
                                            <td
                                                style="text-align: right; font-size:12px; border-color: black; border:1px solid black; vertical-align: middle;">
                                                <tspan
                                                    t-esc="'{:,.2f}'.format(o.as_saldo_inicial - o.obtener_totales())"
                                                    style="margin-right:5px;" />
                                            </td>

                                        </tr>

                                    </thead>
                                </table>
                            </div>
                        </div>
                    </div>
                    <div class="footer" style="font-family: 'Arial' !important;">
                        <style type="text/css">
                            .page {
                                margin: 0px;
                                padding: 0px;
                            }

                            .letra2 {
                                font-size: 12px;
                            }
                        </style>
                        <div class="oe_structure" />

                    </div>
                </t>
            </t>
        </template>
        <template id="as_reporte_libro_caja_previa">
            <t t-call="web.html_container">
                <t t-foreach="docs" t-as="o">
                    <t t-call="as_bo_tesoreria.reporte_de_tesoreria_pdf_preview" t-lang="lang" />
                </t>
                <p style="page-break-after:always;" />
            </t>
        </template>
    </data>
</odoo>