<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <record id="as_request_material_tree" model="ir.ui.view">
            <field name="name">Solicitud de Materiales</field>
            <field name="model">as.request.materials</field>
            <field name="arch" type="xml">
                <tree string="Solicitud de Material">
                    <field name="name" />
                    <field name="as_picking_type_id" />
                    <field name="as_location_id" />
                    <field name="as_location_dest_id" />
                    <field name="as_project_id" />
                    <field name="as_scheduled_date" />
                    <field name="as_date_done" />
                    <field name="as_origin" />
                    <field name="state" />
                </tree>
            </field>
        </record>
        <record id="as_request_material_form" model="ir.ui.view">
            <field name="name">Solicitud de Materiales</field>
            <field name="model">as.request.materials</field>
            <field name="arch" type="xml">
                <form string="Solicitud de materiales">
                    <header>
                    
                        <field name="state" widget="statusbar" statusbar_visible="draft,to_prove,confirmed,done,devuelto,aceptado,cancel" />
                        <!-- <button class="btn-primary" type="action" name="%(as_wiz_transfer_line)d" icon="fa-check" states="confirmed" string="Crear Transferencia"/> -->
                        <field name="as_approval" invisible="True" />
                        <button class="btn-primary" type="object" name="as_get_draft" states="confirmed" string="Borrador" />
                        <button class="btn-primary" type="object" name="as_action_confirm"  string="Confirmar"   attrs="{'invisible': ['|',('as_approval', '=', False),('state', '!=', 'to_prove')]}"/>
                        <button name="button_change_state_materials" type="object" string="Para Aprobar" class="oe_highlight" attrs="{'invisible': [('state', '!=', 'draft')]}"  />
                        <!-- <button name="button_confirm_material" type="object" string="Aprobar" class="oe_highlight" attrs="{'invisible': ['|',('as_approval', '=', False),('state', '!=', 'to_prove')]}"/> -->
                        <!-- <button class="btn-primary" type="action" name="%(as_wiz_transfer_return)d" icon="fa-check" states="done" string="Devolver" /> -->
                        <!-- <button name="generate_pickings" type="object" string="Crear Transferencia"/> -->
                    </header>
                    <sheet>
                     <div name="button_box" class="oe_button_box">
                             <button name="action_picking_expense" type="object" class="oe_stat_button" icon="fa-bus">
                    <field name="picking_count" widget="statinfo" string="Movimientos" />
                </button>
                        </div>
                        <div class="oe_title">
                            <label class="oe_edit_only" for="name" string="Nombre de la Solicitud de materiales" />
                            <h1>
                                <field name="name" placeholder="Titulo de la Solicitud" />
                            </h1>
                        </div>
                        <group col="4">
                            <field name="as_picking_type_id" />
                            <field name="as_gerente_id" required="True"/>
                            <field name="as_location_id" />
                            <field name="user_id" invisible="True"/>
                            <field name="as_location_dest_id" />
                            <field name="as_location_alquiler_id" />
                            <field name="as_project_id" />
                            <field name="as_scheduled_date" />
                            <field name="as_date_done" />
                            <field name="as_origin" />
                            <field name="as_nro_nota" readonly="True" force_save="1"/>
                            <field name="as_return_picks" widget="many2many_tags" invisible="True"/>
                        </group>
                        <field name="lines_ids" widget="section_and_note_one2many">
                            <tree string="Lineas de Solicitudes" editable="bottom">
                                <!-- <control>
                                    <create name="add_product_control" string="Add a product"/>
                                    <create name="add_section_control" string="Add a section" context="{'default_display_type': 'line_section'}"/>
                                    <create name="add_note_control" string="Add a note" context="{'default_display_type': 'line_note'}"/>
                                </control> -->

                                <field name="sequence" widget="handle" />
                                <!-- <field name="name" widget="section_and_note_text" optional="show"/> -->
                                <!-- <field name="display_type"  invisible="1"/> -->
                                <field name="as_alquiler"/>
                                <!-- <field name="product_id" /> -->
                                <field name="product_id" />
                                <field name="product_brand_id"/>
                                <field name="product_model_id"/>
                                <field name="company_id" invisible="True" />
                                <field name="as_location_id"  invisible="True"/>
                                <field name="as_location_dest_id"  invisible="True"/>
                                <field name="as_product_qty"  />
                                <field name="lot_id" widget="many2many_tags"/>
                                <field name="as_devolver"  />
                                <field name="lot_dev_id" widget="many2many_tags"/>
                                <field name="as_stock"  />
                                <field name="product_uom"  />
                                <field name="as_deliver_date"  />
                                <field name="as_nota"/>
                                
                            </tree>
                        </field>
                        <hr/>
                           <group name="note_group" col="6" class="mt-2 mt-md-0">
                                <group colspan="4">
                                    <field name="as_note" nolabel="1" placeholder="Observaciones..."/>
                                    <field name="partner_id" invisible="True"/>
                                </group>
                               
                                <div class="oe_clear"/>
                            </group>
                    </sheet>
                    <div class="oe_chatter">
                    <field name="message_follower_ids" widget="mail_followers" groups="base.group_user"/>
                    <field name="message_ids" widget="mail_thread"/>
                    </div>
                </form>
            </field>
        </record>

        <record id="as_request_materials_action" model="ir.actions.act_window">
            <field name="name">Solicitud de Material</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">as.request.materials</field>
            <field name="view_mode">tree,form</field>
            <field name="view_id" ref="as_request_material_tree" />
            <field name="help" type="html">
                <p class="oe_view_nocontent_create">
                    Haga clic aquí para empezar a crear su primera solicitud de materiales.
                </p>
            </field>
        </record>
        <menuitem id="as_menu_request_materials" parent="project.menu_project_config"
            action="as_request_materials_action" sequence="30" />


        <record id="as_request_materials_line" model="ir.ui.view">
            <field name="name">Solicitud de Materiales lineas</field>
            <field name="model">as.request.lines</field>
            <field name="arch" type="xml">
                <tree string="Solicitud de Material">
                    <field name="as_alquiler" />
                    <field name="product_id" />
                    <field name="product_brand_id" />
                    <field name="product_model_id" />
                    <field name="company_id" invisible="True"/>
                    <!-- <field name="lot_id" groups="stock.group_production_lot" context="{'default_product_id': product_id, 'default_company_id': company_id}"/> -->
                    <field name="as_location_id" />
                    <field name="as_location_dest_id" />
                    <field name="as_product_qty" />
                    <field name="as_qty_done" />
                    <field name="as_devolver" />
                    <field name="as_stock" />
                    <field name="product_uom" />
                    <field name="as_deliver_date" />
                    <field name="as_transfer" />
                    <field name="lot_id" options="{&quot;always_reload&quot;: True, 'no_open': True,'no_create': 1, 'no_create_edit': 1}" force_save="1" />
                    <!-- <field name="as_campo_serie"  /> -->
                    <!-- <field name="picking_general_id" readonly="True" force_save="1" />
                    <field name="picking_in_id"  readonly="True" force_save="1" />
                    <field name="picking_out_id" readonly="True" force_save="1"  /> -->
                </tree>
            </field>
        </record>

        <record id="as_request_materials_line_action" model="ir.actions.act_window">
            <field name="name">Solicitud de Material</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">as.request.lines</field>
            <field name="view_mode">tree,form</field>
            <field name="view_id" ref="as_request_materials_line" />
            <field name="help" type="html">
                <p class="oe_view_nocontent_create">
                    Haga clic aquí para empezar a crear su primera solicitud de materiales lineas.
                </p>
            </field>
        </record>

        <record model="ir.ui.view" id="as_request_amterials_campo_adicional">
            <field name="name">as.request.materials.campo</field>
            <field name="model">as.request.materials</field>
            <field name="inherit_id" ref="as_spectrocom_project.as_request_material_form" />
            <field name="arch" type="xml">
                <xpath expr="//field[@name='as_date_done']" position="after">
                    <field name="as_fecha_instructiva"/>
                </xpath>
            </field>
        </record>
    </data>
</odoo>